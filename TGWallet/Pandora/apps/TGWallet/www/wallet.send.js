webpackJsonp([16],{579:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(0),a=(s(14),s(8),s(6)),o=(s(13),s(10)),l=(s(17),s(15)),r=(s(20),s(11)),d=(s(171),s(172)),i=(s(36),s(33)),c=(s(7),s(2)),u=(s(34),s(31)),m=(s(107),s(108)),v=(s(30),s(28)),h=s(43),f=s(3),A=s(1),w=s(55),k=s(12),b=s(4),p=s(46);n.default.use(v.a),n.default.use(m.a),n.default.use(u.a),n.default.use(c.a),n.default.use(i.a),n.default.use(d.a),n.default.use(o.a).use(l.a).use(r.a);i.a;n.default.use(v.a),n.default.use(m.a),n.default.use(u.a),n.default.use(c.a),n.default.use(i.a),n.default.use(d.a),n.default.use(o.a).use(l.a).use(r.a);var g={data:function(){return{sendAmount:"",sendAmountReadOnly:!1,receiveAddress:"",rangeMin:3,rangeMax:300,rangeValue:3,popupVisible:!1,selected:"",showConfirm:!1,walletName:plus.storage.getItem("walletName"),walletAddress:plus.storage.getItem("walletAddress"),sendAmountError:"",receiveAddressError:"",receiveAddressReadOnly:!1,walletPassword:"",showWalletList:!1,showTokenList:!1,tokenName:"",tokenAddress:"",tokenAddressReadOnly:!1,orderId:"",walletListActions:[],tokenListActions:[],walletOnSelect:"",orderType:"",showTokenSelect:!0}},beforeMount:function(){var e=plus.webview.currentWebview();Object(k.c)(e.receiveAddress)&&(this.receiveAddress=e.receiveAddress,this.receiveAddressReadOnly=!0),Object(k.c)(e.tokenAddress)&&(this.tokenAddress=e.tokenAddress,this.tokenAddressReadOnly=!0),Object(k.c)(e.orderId)&&(this.orderId=e.orderId,this.sendAmountReadOnly=!0),Object(k.c)(e.sendAmount)&&(this.sendAmount=e.sendAmount,this.sendAmountReadOnly=!0),Object(k.c)(e.orderType)&&(this.orderType=e.orderType),this.initSend()},methods:{gasQuestion:function(){v.a.alert({title:"什么是燃料费？",message:"燃料费（Gas）是给矿工的佣金，并以 ETH 支付，无论是交易、执行智能合约并启动 DApps，还是支付数据存储费用，都需要用到燃料费。燃料费价格高低会影响交易的确认速度。",confirmButtonText:"好的"}).then(function(){})},onCancel:function(){this.showWalletList=!1},onSelect:function(e){Object(k.a)(e)||("wallet"===e.type?(this.showWalletList=!1,this.walletName=e.walletName,this.walletAddress=e.walletAddress):(this.showTokenList=!1,this.tokenName=e.tokenName,this.tokenAddress=e.tokenAddress))},send:function(){var e=this,t=Number(this.sendAmount);Object(k.a)(this.receiveAddress)?Object(a.a)("请输入收款地址"):Object(k.a)(this.walletPassword)?Object(a.a)("请输入钱包密码"):Object(k.a)(t)||0===t?Object(a.a)("请输入金额"):v.a.confirm({title:"提示",message:"确认转账吗？（提交后不可撤回）"}).then(function(){a.a.loading({duration:0,forbidClick:!0,loadingType:"spinner",message:"处理中..."}),setTimeout(function(){var s={password:e.walletPassword,tokenAddress:e.tokenAddress,walletAddress:e.walletAddress,receiveAddress:e.receiveAddress,sendAmount:t,gasLimit:w.a.accMul(e.gasValue,1e10),gasPrice:e.gasPrice,orderId:e.orderId};Object(A.a)(f.a.sendTransaction,s).then(function(e){Object(k.a)(e)||(Object(b.a)({url:"./wallet.transInfo.html",id:"wallet.transInfo",title:"交易详情"},{},{tx:e}),setTimeout(function(){Object(A.a)(f.a.shopOrderUpdate,{orderId:s.orderId,transAddress:e})},10)),setTimeout(function(){a.a.clear()},2e3)})},1e3)}).catch(function(){})},closeToken:function(){this.tokenAddress="",this.tokenName=""},contact:function(){},selectToken:function(){var e=this;0===e.tokenListActions.length&&(a.a.loading(),Object(A.a)(f.a.walletTokenList).then(function(t){if(Object(k.a)(t.length))return Object(a.a)("出错了T_T"),!1;for(var s=0;s<t.length;s++)t[s].name=t[s].tokenName,t[s].subname=t[s].tokenAddress.substring(0,10)+"...",t[s].type="token";e.tokenListActions=t,a.a.clear()})),this.showTokenList=!this.showTokenList},selectWallet:function(){var e=this;0===e.walletListActions.length&&(a.a.loading(),Object(A.a)(f.a.walletList).then(function(t){if(Object(k.a)(t.length))return Object(a.a)("出错了T_T"),!1;for(var s=0;s<t.length;s++)t[s].name=t[s].walletName,t[s].subname=t[s].walletAddress.substring(0,10)+"...",t[s].type="wallet";e.walletListActions=t,a.a.clear()})),this.showWalletList=!this.showWalletList},doNext:function(){return Number(this.sendAmount)===Number(0)?(this.sendAmountError="请输入正确的金额",!1):""===this.receiveAddress?(this.receiveAddressError="请输入正确的收款地址",!1):void(this.showConfirm=!this.showConfirm)},initSend:function(){var e=this,t=this;h.a.getGasPrice().then(function(e){t.gasPrice=e}),Object(k.c)(t.tokenAddress)&&h.a.getContractName(t.tokenAddress).then(function(e){t.tokenName=e}),this.orderType!==p.a.shop&&this.orderType!==p.a.virtualShopTg||Object(A.a)(f.a.shopOrderGet,{orderId:this.orderId}).then(function(t){e.sendAmount=t.totalAmount,e.receiveAddress=t.receiveAddress,e.receiveAddressReadOnly=!0,e.showTokenSelect=!1})}},computed:{gasValue:{get:function(){return(Number(this.rangeValue)/1e5).toFixed(7)},set:function(){}}},components:{Field:i.a}},O={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticStyle:{margin:"3%"}},[s("van-cell-group",[s("van-field",{attrs:{label:"金额",placeholder:"","error-message":e.sendAmountError,readonly:e.sendAmountReadOnly,disabled:e.sendAmountReadOnly,type:"number"},on:{input:function(t){e.sendAmountError=""}},model:{value:e.sendAmount,callback:function(t){e.sendAmount=t},expression:"sendAmount"}},[s("van-icon",{directives:[{name:"show",rawName:"v-show",value:e.showTokenSelect,expression:"showTokenSelect"}],attrs:{slot:"icon",name:"more-o"},on:{click:e.selectToken},slot:"icon"})],1),e._v(" "),s("van-field",{directives:[{name:"show",rawName:"v-show",value:e.tokenAddress,expression:"tokenAddress"}],attrs:{label:"交易合约",readonly:e.tokenAddressReadOnly,disabled:e.tokenAddressReadOnly},model:{value:e.tokenAddress,callback:function(t){e.tokenAddress=t},expression:"tokenAddress"}},[s("van-icon",{directives:[{name:"show",rawName:"v-show",value:!e.tokenAddressReadOnly,expression:"!tokenAddressReadOnly"}],attrs:{slot:"icon",name:"close"},on:{click:e.closeToken},slot:"icon"})],1),e._v(" "),s("van-field",{directives:[{name:"show",rawName:"v-show",value:e.tokenAddress,expression:"tokenAddress"}],attrs:{label:"合约名称",readonly:e.tokenAddressReadOnly,disabled:e.tokenAddressReadOnly},model:{value:e.tokenName,callback:function(t){e.tokenName=t},expression:"tokenName"}}),e._v(" "),s("van-field",{attrs:{label:"收款方",placeholder:"收款钱包地址","error-message":e.receiveAddressError,clearable:!0,readonly:e.receiveAddressReadOnly,disabled:e.receiveAddressReadOnly},on:{input:function(t){e.receiveAddressError=""}},model:{value:e.receiveAddress,callback:function(t){e.receiveAddress=t},expression:"receiveAddress"}},[s("van-icon",{attrs:{slot:"icon",name:"contact"},on:{click:e.contact},slot:"icon"})],1),e._v(" "),s("van-field",{attrs:{label:"燃料费(ETH)",readonly:!0,disableClear:""},model:{value:e.gasValue,callback:function(t){e.gasValue=t},expression:"gasValue"}},[s("van-icon",{attrs:{slot:"icon",name:"question-o"},on:{click:e.gasQuestion},slot:"icon"})],1),e._v(" "),s("van-slider",{attrs:{min:e.rangeMin,max:e.rangeMax,step:1e-5},model:{value:e.rangeValue,callback:function(t){e.rangeValue=t},expression:"rangeValue"}})],1),e._v(" "),s("van-popup",{staticClass:"confirm",model:{value:e.showConfirm,callback:function(t){e.showConfirm=t},expression:"showConfirm"}},[s("van-field",{attrs:{label:"金额",readonly:!0,disabled:!0},model:{value:e.sendAmount,callback:function(t){e.sendAmount=t},expression:"sendAmount"}},[s("span",{staticStyle:{color:"dodgerblue","font-size":"16px"}},[e._v("ETH")])]),e._v(" "),s("van-field",{attrs:{label:"钱包","is-link":"",readonly:!0},on:{click:e.selectWallet},model:{value:e.walletName,callback:function(t){e.walletName=t},expression:"walletName"}}),e._v(" "),s("van-field",{attrs:{label:"交易密码",type:"password"},model:{value:e.walletPassword,callback:function(t){e.walletPassword=t},expression:"walletPassword"}}),e._v(" "),s("van-button",{directives:[{name:"intervalclick",rawName:"v-intervalclick",value:{func:e.send},expression:"{func:send}"}],staticClass:"sendButton button-blue",attrs:{type:"primary",size:"large"}},[e._v("\n      立即转账\n    ")])],1),e._v(" "),s("van-actionsheet",{attrs:{"cancel-text":"取消",actions:e.walletListActions},on:{select:e.onSelect,cancel:e.onCancel},model:{value:e.showWalletList,callback:function(t){e.showWalletList=t},expression:"showWalletList"}}),e._v(" "),s("van-actionsheet",{attrs:{"cancel-text":"取消",actions:e.tokenListActions},on:{select:e.onSelect,cancel:e.onCancel},model:{value:e.showTokenList,callback:function(t){e.showTokenList=t},expression:"showTokenList"}}),e._v(" "),s("van-button",{directives:[{name:"intervalclick",rawName:"v-intervalclick",value:{func:e.doNext},expression:"{func:doNext}"}],staticClass:"doNext button-blue",attrs:{type:"primary",size:"large"}},[e._v("\n    确认转账\n  ")])],1)},staticRenderFns:[]};var y=s(9)(g,O,!1,function(e){s(580)},"data-v-5d42409d",null).exports;new n.default({el:"#app",render:function(e){return e(y)}})},580:function(e,t){}},[579]);