webpackJsonp([3],{530:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=s(0),n=(s(14),s(8),s(6)),a=(s(34),s(31)),u=(s(16),s(82),s(134),s(246),s(247),s(532),s(533),s(163),s(534),s(535),s(32)),o=s(26),r=s.n(o),c=s(5),l=s(112),d=s(83),h=s(119),m=s(120),v=Object(c.k)("image-preview"),f=v[0],p=v[1];function k(t){return Math.sqrt(Math.abs((t[0].clientX-t[1].clientX)*(t[0].clientY-t[1].clientY)))}var g,S=f({mixins:[l.a,d.a],props:{images:Array,className:null,lazyLoad:Boolean,asyncClose:Boolean,startPosition:Number,showIndicators:Boolean,loop:{type:Boolean,default:!0},overlay:{type:Boolean,default:!0},showIndex:{type:Boolean,default:!0},minZoom:{type:Number,default:1/3},maxZoom:{type:Number,default:3},overlayClass:{type:String,default:"van-image-preview__overlay"},closeOnClickOverlay:{type:Boolean,default:!0}},data:function(){return{scale:1,moveX:0,moveY:0,moving:!1,zooming:!1,active:0}},computed:{imageStyle:function(){var t=this.scale,e={transition:this.zooming||this.moving?"":".3s all"};return 1!==t&&(e.transform="scale3d("+t+", "+t+", 1) translate("+this.moveX/t+"px, "+this.moveY/t+"px)"),e}},watch:{value:function(){this.active=this.startPosition},startPosition:function(t){this.active=t}},methods:{onWrapperTouchStart:function(){this.touchStartTime=new Date},onWrapperTouchEnd:function(t){t.preventDefault();var e=new Date-this.touchStartTime,s=this.$refs.swipe||{},i=s.offsetX,n=void 0===i?0:i,a=s.offsetY;if(e<300&&n<10&&(void 0===a?0:a)<10){var u=this.active;this.resetScale(),this.$emit("close",{index:u,url:this.images[u]}),this.asyncClose||this.$emit("input",!1)}},startMove:function(t){var e=t.currentTarget.getBoundingClientRect(),s=window.innerWidth,i=window.innerHeight;this.touchStart(t),this.moving=!0,this.startMoveX=this.moveX,this.startMoveY=this.moveY,this.maxMoveX=Math.max(0,(e.width-s)/2),this.maxMoveY=Math.max(0,(e.height-i)/2)},startZoom:function(t){this.moving=!1,this.zooming=!0,this.startScale=this.scale,this.startDistance=k(t.touches)},onTouchStart:function(t){var e=t.touches,s=(this.$refs.swipe||{}).offsetX,i=void 0===s?0:s;1===e.length&&1!==this.scale?this.startMove(t):2!==e.length||i||this.startZoom(t)},onTouchMove:function(t){var e=t.touches;if((this.moving||this.zooming)&&(t.preventDefault(),t.stopPropagation()),this.moving){this.touchMove(t);var s=this.deltaX+this.startMoveX,i=this.deltaY+this.startMoveY;this.moveX=Object(c.j)(s,-this.maxMoveX,this.maxMoveX),this.moveY=Object(c.j)(i,-this.maxMoveY,this.maxMoveY)}if(this.zooming&&2===e.length){var n=k(e),a=this.startScale*n/this.startDistance;this.scale=Object(c.j)(a,this.minZoom,this.maxZoom)}},onTouchEnd:function(t){if(this.moving||this.zooming){var e=!0;this.moving&&this.startMoveX===this.moveX&&this.startMoveY===this.moveY&&(e=!1),t.touches.length||(this.moving=!1,this.zooming=!1,this.startMoveX=0,this.startMoveY=0,this.startScale=1,this.scale<1&&this.resetScale()),e&&(t.preventDefault(),t.stopPropagation())}},onChange:function(t){this.resetScale(),this.active=t,this.$emit("change",t)},resetScale:function(){this.scale=1,this.moveX=0,this.moveY=0}},render:function(t){var e=this;if(this.value){var s=this.active,i=this.images,n=this.showIndex&&t("div",{class:p("index")},[this.slots("index")||s+1+"/"+i.length]),a=t(h.a,{ref:"swipe",attrs:{loop:this.loop,indicatorColor:"white",initialSwipe:this.startPosition,showIndicators:this.showIndicators},on:{change:this.onChange}},[i.map(function(i,n){var a={class:p("image"),style:n===s?e.imageStyle:null,on:{touchstart:e.onTouchStart,touchmove:e.onTouchMove,touchend:e.onTouchEnd,touchcancel:e.onTouchEnd}};return t(m.a,[e.lazyLoad?t("img",r()([{directives:[{name:"lazy",value:i}]},a])):t("img",r()([{attrs:{src:i}},a]))])})]);return t("transition",{attrs:{name:"van-fade"}},[t("div",{class:[p(),this.className],on:{touchstart:this.onWrapperTouchStart,touchend:this.onWrapperTouchEnd,touchcancel:this.onWrapperTouchEnd}},[n,a])])}}}),b={images:[],loop:!0,value:!0,minZoom:1/3,maxZoom:3,className:"",lazyLoad:!1,showIndex:!0,asyncClose:!1,startPosition:0,showIndicators:!1},y=function(t,e){if(void 0===e&&(e=0),!c.h){g||(g=new(i.default.extend(S))({el:document.createElement("div")}),document.body.appendChild(g.$el));var s=Array.isArray(t)?{images:t,startPosition:e}:t;return Object(u.a)(g,b,s),g.$once("input",function(t){g.value=t}),s.onClose&&g.$once("close",s.onClose),g}};y.install=function(){i.default.use(S)};var C=y,F=s(29),_=s(11),x=Object(c.k)("sku-header"),O=x[0],T=x[1];function w(t,e,s,i){var n=e.sku,a=e.goods,u=e.skuEventBus,o=function(t,e){var s=e.s1;if(s){var i=t.tree.filter(function(t){return"s1"===t.k_s})[0]||{};if(i.v){var n=i.v.filter(function(t){return t.id===s})[0];if(n)return n.imgUrl||n.img_url}}}(n,e.selectedSku)||a.picture;return t("div",r()([{class:[T(),"van-hairline--bottom"]},Object(F.b)(i)]),[t("div",{class:T("img-wrap"),on:{click:function(){u.$emit("sku:previewImage",o)}}},[t("img",{attrs:{src:o}})]),t("div",{class:T("goods-info")},[t("div",{class:"van-sku__goods-name van-ellipsis"},[a.title]),s.default&&s.default(),t(_.a,{attrs:{name:"close"},class:"van-sku__close-icon",on:{click:function(){u.$emit("sku:close")}}})])])}w.props={sku:Object,goods:Object,skuEventBus:Object,selectedSku:Object};var I=O(w),A=Object(c.k)("sku-row"),B=A[0],M=A[1];function $(t,e,s,i){return t("div",r()([{class:M()},Object(F.b)(i)]),[t("div",{class:M("title")},[e.skuRow.k,"："]),s.default&&s.default()])}$.props={skuRow:Object};var j=B($),N={QUOTA_LIMIT:0,STOCK_LIMIT:1},D={LIMIT_TYPE:N,UNSELECTED_SKU_VALUE_ID:""},E=function(t){var e={};return t.forEach(function(t){e[t.k_s]=t.v}),e},V=function(t,e){var s=Object.keys(e).filter(function(t){return""!==e[t]});return t.length===s.length},z=function(t,e){return t.filter(function(t){return Object.keys(e).every(function(s){return String(t[s])===String(e[s])})})[0]},L=function(t,e){var s=E(t);return Object.keys(e).reduce(function(t,i){var n=s[i],a=e[i];if(""!==a){var u=n.filter(function(t){return t.id===a})[0];u&&t.push(u)}return t},[])},q=function(t,e,s){var i,n=s.key,a=s.valueId,o=Object(u.a)({},e,((i={})[n]=a,i)),r=Object.keys(o).filter(function(t){return""!==o[t]});return t.filter(function(t){return r.every(function(e){return String(o[e])===String(t[e])})}).reduce(function(t,e){return t+=e.stock_num},0)>0},R={normalizeSkuTree:E,getSkuComb:z,getSelectedSkuValues:L,isAllSelected:V,isSkuChoosable:q},P=(0,Object(c.k)("sku-row-item")[0])({props:{skuList:Array,skuValue:Object,skuKeyStr:String,skuEventBus:Object,selectedSku:Object},computed:{choosable:function(){return q(this.skuList,this.selectedSku,{key:this.skuKeyStr,valueId:this.skuValue.id})}},methods:{onSelect:function(){this.choosable&&this.skuEventBus.$emit("sku:select",Object(u.a)({},this.skuValue,{skuKeyStr:this.skuKeyStr}))}},render:function(t){return t("span",{class:["van-sku-row__item",{"van-sku-row__item--active":this.skuValue.id===this.selectedSku[this.skuKeyStr],"van-sku-row__item--disabled":!this.choosable}],on:{click:this.onSelect}},[this.skuValue.name])}}),U=Object(c.k)("stepper"),X=U[0],Y=U[1],K=X({props:{value:null,integer:Boolean,disabled:Boolean,inputWidth:String,asyncChange:Boolean,disableInput:Boolean,min:{type:[String,Number],default:1},max:{type:[String,Number],default:1/0},step:{type:[String,Number],default:1},defaultValue:{type:[String,Number],default:1}},data:function(){var t=this.range(Object(c.d)(this.value)?this.value:this.defaultValue);return t!==+this.value&&this.$emit("input",t),{currentValue:t}},computed:{minusDisabled:function(){return this.disabled||this.currentValue<=this.min},plusDisabled:function(){return this.disabled||this.currentValue>=this.max}},watch:{value:function(t){t!==this.currentValue&&(this.currentValue=this.format(t))},currentValue:function(t){this.$emit("input",t),this.$emit("change",t)}},methods:{format:function(t){return""===(t=String(t).replace(/[^0-9.-]/g,""))?0:this.integer?Math.floor(t):+t},range:function(t){return Math.max(Math.min(this.max,this.format(t)),this.min)},onInput:function(t){var e=t.target.value,s=this.format(e);this.asyncChange?(t.target.value=this.currentValue,this.$emit("input",s),this.$emit("change",s)):(+e!==s&&(t.target.value=s),this.currentValue=s)},onChange:function(t){if(this[t+"Disabled"])this.$emit("overlimit",t);else{var e="minus"===t?-this.step:+this.step,s=Math.round(100*(this.currentValue+e))/100;this.asyncChange?(this.$emit("input",s),this.$emit("change",s)):this.currentValue=this.range(s),this.$emit(t)}},onFocus:function(t){this.$emit("focus",t)},onBlur:function(t){this.currentValue=this.range(this.currentValue),this.$emit("blur",t),0===this.currentValue&&(t.target.value=this.currentValue)}},render:function(t){var e=this,s=function(t){return function(){e.onChange(t)}};return t("div",{class:Y()},[t("button",{class:Y("minus",{disabled:this.minusDisabled}),on:{click:s("minus")}}),t("input",{attrs:{type:"number",disabled:this.disabled||this.disableInput},class:Y("input"),domProps:{value:this.currentValue},style:{width:this.inputWidth},on:{input:this.onInput,focus:this.onFocus,blur:this.onBlur}}),t("button",{class:Y("plus",{disabled:this.plusDisabled}),on:{click:s("plus")}})])}}),G=Object(c.k)("sku-stepper")[0],H=N.QUOTA_LIMIT,Q=N.STOCK_LIMIT,W=G({props:{quota:Number,quotaUsed:Number,hideStock:Boolean,skuEventBus:Object,skuStockNum:Number,selectedSku:Object,selectedNum:Number,stepperTitle:String,hideQuotaText:Boolean,selectedSkuComb:Object,disableStepperInput:Boolean,customStepperConfig:Object},data:function(){return{currentNum:this.selectedNum,limitType:Q}},watch:{currentNum:function(t){this.skuEventBus.$emit("sku:numChange",t)},stepperLimit:function(t){t<this.currentNum&&(this.currentNum=t)}},computed:{stock:function(){var t=this.customStepperConfig.stockNum;return void 0!==t?t:this.selectedSkuComb?this.selectedSkuComb.stock_num:this.skuStockNum},stockText:function(){var t=this.customStepperConfig.stockFormatter;return t?t(this.stock):"剩余"+this.stock+"件"},quotaText:function(){var t=this.customStepperConfig,e=t.quotaText;if(t.hideQuotaText)return"";var s="";return e?s=e:this.quota>0&&(s="每人限购"+this.quota+"件"),s},stepperLimit:function(){var t,e=this.quota-this.quotaUsed;return this.quota>0&&e<=this.stock?(t=e<0?0:e,this.limitType=H):(t=this.stock,this.limitType=Q),t}},methods:{setCurrentNum:function(t){this.currentNum=t},onOverLimit:function(t){this.skuEventBus.$emit("sku:overLimit",{action:t,limitType:this.limitType,quota:this.quota,quotaUsed:this.quotaUsed})},onChange:function(t){var e=this.customStepperConfig.handleStepperChange;e&&e(t),this.$emit("change",t)}},render:function(t){var e=this;return t("div",{class:"van-sku-stepper-stock"},[t("div",{class:"van-sku-stepper-container"},[t("div",{class:"van-sku__stepper-title"},[this.stepperTitle||"购买数量","："]),t(K,{class:"van-sku__stepper",attrs:{max:this.stepperLimit,disableInput:this.disableStepperInput},on:{overlimit:this.onOverLimit,change:this.onChange},model:{value:e.currentNum,callback:function(t){e.currentNum=t}}})]),!this.hideStock&&t("div",{class:"van-sku__stock"},[this.stockText]),!this.hideQuotaText&&this.quotaText&&t("div",{class:"van-sku__quota"},[this.quotaText])])}}),Z=s(10),J=s(15),tt=s(33);function et(t){return/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(t)}function st(t){return/^\d+$/.test(t)}var it=s(69),nt=Object(c.k)("uploader"),at=nt[0],ut=nt[1],ot=at({inheritAttrs:!1,props:{disabled:Boolean,beforeRead:Function,afterRead:Function,accept:{type:String,default:"image/*"},resultType:{type:String,default:"dataUrl"},maxSize:{type:Number,default:Number.MAX_VALUE}},computed:{detail:function(){return{name:this.$attrs.name||""}}},methods:{onChange:function(t){var e=this,s=t.target.files;!this.disabled&&s.length&&(!(s=1===s.length?s[0]:[].slice.call(s,0))||this.beforeRead&&!this.beforeRead(s,this.detail)?this.resetInput():Array.isArray(s)?Promise.all(s.map(this.readFile)).then(function(t){var i=!1,n=s.map(function(n,a){return n.size>e.maxSize&&(i=!0),{file:s[a],content:t[a]}});e.onAfterRead(n,i)}):this.readFile(s).then(function(t){e.onAfterRead({file:s,content:t},s.size>e.maxSize)}))},readFile:function(t){var e=this;return new Promise(function(s){var i=new FileReader;i.onload=function(t){s(t.target.result)},"dataUrl"===e.resultType?i.readAsDataURL(t):"text"===e.resultType&&i.readAsText(t)})},onAfterRead:function(t,e){e?this.$emit("oversize",t):this.afterRead&&this.afterRead(t,this.detail),this.resetInput()},resetInput:function(){this.$refs.input&&(this.$refs.input.value="")}},render:function(t){var e=this.accept,s=this.disabled;return t("div",{class:ut()},[this.slots(),t("input",{attrs:Object(u.a)({},this.$attrs,{type:"file",accept:e,disabled:s}),ref:"input",class:ut("input"),on:{change:this.onChange}})])}}),rt=Object(c.k)("sku-img-uploader"),ct=rt[0],lt=rt[1],dt=ct({props:{value:String,uploadImg:Function,maxSize:{type:Number,default:6}},data:function(){return{paddingImg:""}},computed:{imgList:function(){return this.value&&!this.paddingImg?[this.value]:[]}},methods:{afterReadFile:function(t){var e=this;this.paddingImg=t.content,this.uploadImg(t.file,t.content).then(function(t){e.$emit("input",t),e.$nextTick(function(){e.paddingImg=""})}).catch(function(){e.paddingImg=""})},onOversize:function(){this.$toast("最大可上传图片为"+this.maxSize+"MB，请尝试压缩图片尺寸")}},render:function(t){var e=this,s=this.imgList,i=this.paddingImg,n=(i||s.length>0)&&t("div",{class:"van-clearfix"},[s.map(function(s){return t("div",{class:lt("img")},[t("img",{attrs:{src:s}}),t(_.a,{attrs:{name:"clear"},class:lt("delete"),on:{click:function(){e.$emit("input","")}}})])}),i&&t("div",{class:lt("img")},[t("img",{attrs:{src:i}}),t(it.a,{attrs:{type:"spinner"},class:lt("uploading")})])]);return t("div",{class:lt()},[t(ot,{attrs:{disabled:!!i,afterRead:this.afterReadFile,maxSize:1024*this.maxSize*1024},on:{oversize:this.onOversize}},[t("div",{class:lt("header")},[i?t("div",["正在上传..."]):[t(_.a,{attrs:{name:"photograph"}}),t("span",{class:"label"},[this.value?"重拍":"拍照"," 或 "]),t(_.a,{attrs:{name:"photo"}}),t("span",{class:"label"},[this.value?"重新选择照片":"选择照片"])]])]),n])}}),ht=Object(c.k)("sku-messages"),mt=ht[0],vt=ht[1],ft={id_no:"输入身份证号码",text:"输入文本",tel:"输入数字",email:"输入邮箱",date:"点击选择日期",time:"点击选择时间",textarea:"点击填写段落文本",mobile:"输入手机号码"},pt=mt({props:{messages:Array,messageConfig:Object,goodsId:[Number,String]},data:function(){return{messageValues:this.resetMessageValues(this.messages)}},watch:{messages:function(t){this.messageValues=this.resetMessageValues(t)}},methods:{resetMessageValues:function(t){return(t||[]).map(function(){return{value:""}})},getType:function(t){return 1==+t.multiple?"textarea":"id_no"===t.type?"text":t.datetime>0?"datetime-local":t.type},getMessages:function(){var t=this,e={};return this.messageValues.forEach(function(s,i){var n=s.value;t.messages[i].datetime>0&&(n=n.replace(/T/g," ")),e["message_"+i]=n}),e},getCartMessages:function(){var t=this,e={};return this.messageValues.forEach(function(s,i){var n=s.value,a=t.messages[i];a.datetime>0&&(n=n.replace(/T/g," ")),e[a.name]=n}),e},getPlaceholder:function(t){var e=1==+t.multiple?"textarea":t.type;return(this.messageConfig.placeholderMap||{})[e]||ft[e]},validateMessages:function(){for(var t=this.messageValues,e=0;e<t.length;e++){var s=t[e].value,i=this.messages[e];if(""===s){if("1"===String(i.required))return("image"===i.type?"请上传":"请填写")+i.name}else{if("tel"===i.type&&!st(s))return"请填写正确的数字格式留言";if("mobile"===i.type&&!/^\d{6,20}$/.test(s))return"手机号长度为6-20位数字";if("email"===i.type&&!et(s))return"请填写正确的邮箱";if("id_no"===i.type&&(s.length<15||s.length>18))return"请填写正确的身份证号码"}}},onBlur:function(){Object(c.e)()&&window.scrollTo(0,0)}},render:function(t){var e=this;return t(J.a,{class:vt()},[this.messages.map(function(s,i){return"image"===s.type?t(Z.a,{class:vt("image-cell"),attrs:{label:"仅限一张",title:s.name,required:"1"===String(s.required)},key:e.goodsId+"-"+i},[t(dt,{attrs:{uploadImg:e.messageConfig.uploadImg,maxSize:e.messageConfig.uploadMaxSize},model:{value:e.messageValues[i].value,callback:function(t){e.messageValues[i].value=t}}})]):t(tt.a,{attrs:{maxlength:"200",label:s.name,required:"1"===String(s.required),placeholder:e.getPlaceholder(s),type:e.getType(s)},key:e.goodsId+"-"+i,on:{blur:e.onBlur},model:{value:e.messageValues[i].value,callback:function(t){e.messageValues[i].value=t}}})})])}}),kt=s(2),gt=Object(c.k)("sku-actions"),St=gt[0],bt=gt[1];function yt(t,e,s,i){var n=function(t){return function(){e.skuEventBus.$emit(t)}};return t("div",r()([{class:bt()},Object(F.b)(i)]),[e.showAddCartBtn&&t(kt.a,{attrs:{bottomAction:!0,text:"加入购物车"},on:{click:n("sku:addCart")}}),t(kt.a,{attrs:{type:"primary",bottomAction:!0,text:e.buyText||"立即购买"},on:{click:n("sku:buy")}})])}yt.props={buyText:String,skuEventBus:Object,showAddCartBtn:Boolean};var Ct=St(yt),Ft=Object(c.k)("sku")[0],_t=N.QUOTA_LIMIT,xt=Ft({props:{sku:Object,goods:Object,quota:Number,value:Boolean,buyText:String,quotaUsed:Number,goodsId:[Number,String],hideStock:Boolean,hideQuotaText:Boolean,stepperTitle:String,getContainer:Function,customSkuValidator:Function,closeOnClickOverlay:Boolean,disableStepperInput:Boolean,resetStepperOnHide:Boolean,resetSelectedSkuOnHide:Boolean,initialSku:{type:Object,default:function(){return{}}},showSoldoutSku:{type:Boolean,default:!0},showAddCartBtn:{type:Boolean,default:!0},bodyOffsetTop:{type:Number,default:200},messageConfig:{type:Object,default:function(){return{placeholderMap:{},uploadImg:function(){return Promise.resolve()},uploadMaxSize:5}}},customStepperConfig:{type:Object,default:function(){return{}}}},data:function(){return{selectedSku:{},selectedNum:1,show:this.value}},watch:{show:function(t){if(this.$emit("input",t),!t){var e=L(this.sku.tree,this.selectedSku);this.$emit("sku-close",{selectedSkuValues:e,selectedNum:this.selectedNum,selectedSkuComb:this.selectedSkuComb}),this.resetStepperOnHide&&this.resetStepper(),this.resetSelectedSkuOnHide&&this.resetSelectedSku(this.skuTree)}},value:function(t){this.show=t},skuTree:function(t){this.resetSelectedSku(t)}},computed:{skuGroupClass:function(){return["van-sku-group-container","van-hairline--bottom",{"van-sku-group-container--hide-soldout":!this.showSoldoutSku}]},bodyStyle:function(){if(!this.$isServer)return{maxHeight:window.innerHeight-this.bodyOffsetTop+"px"}},isSkuCombSelected:function(){return V(this.sku.tree,this.selectedSku)},isSkuEmpty:function(){return 0===Object.keys(this.sku).length},hasSku:function(){return!this.sku.none_sku},selectedSkuComb:function(){return this.hasSku?this.isSkuCombSelected?z(this.sku.list,this.selectedSku):null:{id:this.sku.collection_id,price:Math.round(100*this.sku.price),stock_num:this.sku.stock_num}},price:function(){return this.selectedSkuComb?(this.selectedSkuComb.price/100).toFixed(2):this.sku.price},skuTree:function(){return this.sku.tree||[]},imageList:function(){var t=[this.goods.picture];if(this.skuTree.length>0){var e=this.skuTree.filter(function(t){return"s1"===t.k_s})[0]||{};if(!e.v)return;e.v.forEach(function(e){var s=e.imgUrl||e.img_url;s&&t.push(s)})}return t}},created:function(){var t=new i.default;this.skuEventBus=t,t.$on("sku:close",this.onClose),t.$on("sku:select",this.onSelect),t.$on("sku:numChange",this.onNumChange),t.$on("sku:previewImage",this.onPreviewImage),t.$on("sku:overLimit",this.onOverLimit),t.$on("sku:addCart",this.onAddCart),t.$on("sku:buy",this.onBuy),this.resetStepper(),this.resetSelectedSku(this.skuTree),this.$emit("after-sku-create",t)},methods:{resetStepper:function(){var t=this.$refs.skuStepper,e=this.initialSku.selectedNum,s=Object(c.d)(e)?e:1;t?t.setCurrentNum(s):this.selectedNum=s},resetSelectedSku:function(t){var e=this;this.selectedSku={},t.forEach(function(t){e.selectedSku[t.k_s]=e.initialSku[t.k_s]||""}),t.forEach(function(t){var s=t.k_s,i=t.v[0].id;1===t.v.length&&q(e.sku.list,e.selectedSku,{key:s,valueId:i})&&(e.selectedSku[s]=i)})},getSkuMessages:function(){return this.$refs.skuMessages?this.$refs.skuMessages.getMessages():{}},getSkuCartMessages:function(){return this.$refs.skuMessages?this.$refs.skuMessages.getCartMessages():{}},validateSkuMessages:function(){return this.$refs.skuMessages?this.$refs.skuMessages.validateMessages():""},validateSku:function(){if(0===this.selectedNum)return"商品已经无法购买啦";if(this.isSkuCombSelected)return this.validateSkuMessages();if(this.customSkuValidator){var t=this.customSkuValidator(this);if(t)return t}return"请先选择商品规格"},onClose:function(){this.show=!1},onSelect:function(t){var e,s;this.selectedSku=this.selectedSku[t.skuKeyStr]===t.id?Object(u.a)({},this.selectedSku,((e={})[t.skuKeyStr]="",e)):Object(u.a)({},this.selectedSku,((s={})[t.skuKeyStr]=t.id,s)),this.$emit("sku-selected",{skuValue:t,selectedSku:this.selectedSku,selectedSkuComb:this.selectedSkuComb})},onNumChange:function(t){this.selectedNum=t},onPreviewImage:function(t){var e=this,s=this.imageList.findIndex(function(e){return e===t}),i={index:s,imageList:this.imageList,indexImage:t};this.$emit("preview-on",i),C({images:this.imageList,startPosition:s,onClose:function(){e.$emit("preview-close",i)}})},onOverLimit:function(t){var e=t.action,s=t.limitType,i=t.quota,a=t.quotaUsed,u=this.customStepperConfig.handleOverLimit;if(u)u(t);else if("minus"===e)Object(n.a)("至少选择一件");else if("plus"===e)if(s===_t){var o="限购"+i+"件";a>0&&(o+="，你已购买"+a+"件"),Object(n.a)(o)}else Object(n.a)("库存不足")},onAddCart:function(){this.onBuyOrAddCart("add-cart")},onBuy:function(){this.onBuyOrAddCart("buy-clicked")},onBuyOrAddCart:function(t){var e=this.validateSku();e?Object(n.a)(e):this.$emit(t,this.getSkuData())},getSkuData:function(){return{goodsId:this.goodsId,selectedNum:this.selectedNum,selectedSkuComb:this.selectedSkuComb,messages:this.getSkuMessages(),cartMessages:this.getSkuCartMessages()}}},render:function(t){var e=this;if(!this.isSkuEmpty){var s=this.sku,i=this.goods,n=this.price,u=this.skuEventBus,o=this.selectedSku,r=this.selectedNum,c=this.stepperTitle,l=this.hideQuotaText,d=this.selectedSkuComb,h={price:n,selectedNum:r,skuEventBus:u,selectedSku:o,selectedSkuComb:d},m=function(t){return e.slots(t,h)},v=m("sku-header")||t(I,{attrs:{sku:s,goods:i,skuEventBus:u,selectedSku:o}},[m("sku-header-price")||t("div",{class:"van-sku__goods-price"},[t("span",{class:"van-sku__price-symbol"},["￥"]),t("span",{class:"van-sku__price-num"},[n])])]),f=m("sku-group")||this.hasSku&&t("div",{class:this.skuGroupClass},[this.skuTree.map(function(e){return t(j,{attrs:{skuRow:e}},[e.v.map(function(i){return t(P,{attrs:{skuList:s.list,skuValue:i,selectedSku:o,skuEventBus:u,skuKeyStr:e.k_s}})})])})]),p=m("sku-stepper")||t(W,{ref:"skuStepper",attrs:{quota:this.quota,hideStock:this.hideStock,quotaUsed:this.quotaUsed,skuEventBus:u,selectedNum:r,selectedSku:o,stepperTitle:c,skuStockNum:s.stock_num,hideQuotaText:l,selectedSkuComb:d,disableStepperInput:this.disableStepperInput,customStepperConfig:this.customStepperConfig},on:{change:function(t){e.$emit("stepper-change",t)}}}),k=m("sku-messages")||t(pt,{ref:"skuMessages",attrs:{goodsId:this.goodsId,messageConfig:this.messageConfig,messages:s.messages}}),g=m("sku-actions")||t(Ct,{attrs:{buyText:this.buyText,skuEventBus:u,showAddCartBtn:this.showAddCartBtn}});return t(a.a,{attrs:{position:"bottom",getContainer:this.getContainer,closeOnClickOverlay:this.closeOnClickOverlay},class:"van-sku-container",model:{value:e.show,callback:function(t){e.show=t}}},[v,t("div",{class:"van-sku-body",style:this.bodyStyle},[m("sku-body-top"),f,m("extra-sku-group"),p,k]),g])}}});xt.SkuActions=Ct,xt.SkuHeader=I,xt.SkuMessages=pt,xt.SkuStepper=W,xt.SkuRow=j,xt.SkuRowItem=P,xt.skuHelper=R,xt.skuConstants=D;var Ot=xt,Tt=(s(61),s(62)),wt=(s(59),s(60)),It=(s(7),s(36),s(53),s(45)),At=(s(13),s(52),s(44)),Bt=(s(12),s(37)),Mt=s(3),$t=s(1),jt=s(4),Nt=s(46);i.default.use(a.a).use(Ot).use(Tt.a).use(wt.a).use(kt.a).use(tt.a).use(It.a).use(Z.a).use(At.a);i.default.use(a.a).use(Ot).use(Tt.a).use(wt.a).use(kt.a).use(tt.a).use(It.a).use(Z.a).use(At.a);var Dt={name:"charitable",data:function(){return{selected:0,anonymous:"",info:null,tokenAddress:Bt.a.tokenAddress,showBase:!1,sendAmount:""}},created:function(){var t=this,e={one2OneId:plus.webview.currentWebview().donationId};Object($t.a)(Mt.a.donationOne2oneGetInfo,e).then(function(e){t.info=e})},methods:{onBuyClicked:function(){},onAddCartClicked:function(){},pop:function(){return this.showBase=!0,!1},donation:function(){if(0===Number(this.sendAmount))return Object(n.a)("请填写捐款金额"),!1;this.info.blAddress;var t=this.info,e={donationType:t.donationType,donationId:t.donationId,donationTitle:"捐助"+t.name,blAddress:t.blAddress,uid:plus.storage.getItem("uid"),userName:"",amount:this.sendAmount};Object($t.a)(Mt.a.donationCreateOrder,e).then(function(t){Object(jt.a)({url:"./wallet.send.html",id:"wallet.send",title:"捐款收银台",titleStyle:{titleText:"捐款收银台",autoBackButton:!0,progress:{color:"#ff5c0a",height:"1%"}}},{},{receiveAddress:e.blAddress,sendAmount:e.amount,tokenAddress:Bt.a.tokenAddress,orderId:t,orderType:Nt.a.donation})})}}},Et={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"primarySchool-body"}},[null===t.info?s("div"):s("div",[s("div",{attrs:{id:"primarySchool-banner"}},[s("img",{attrs:{src:t.info.smallImg}})]),t._v(" "),s("div",{staticClass:"primarySchool-text"},[s("div",{staticClass:"primarySchool-text-title"},[t._v("捐助项目")]),t._v(" "),s("div",{staticClass:"primarySchool-text-desc"},[t._v(t._s(t.info.donationBrief))])]),t._v(" "),s("div",{attrs:{id:"primarySchool-sum"}},[s("div",{staticClass:"item"},[t._v("\n        "+t._s(t.info.receiveAmount)+"\n        "),s("div",{staticClass:"unit"},[t._v("捐赠总额 (TG)")])]),t._v(" "),s("div",{staticClass:"item"},[t._v("\n        "+t._s(t.info.donationPeopleNum)+"\n        "),s("div",{staticClass:"unit"},[t._v("捐赠人数")])])]),t._v(" "),s("div",{staticClass:"primarySchool-text"},[s("div",{staticClass:"primarySchool-text-title"},[t._v(t._s(t.info.name)+"的区块链地址")]),t._v(" "),s("div",{staticClass:"primarySchool-text-desc"},[t._v("\n        "+t._s(t.info.blAddress)+"\n      ")])]),t._v(" "),1===t.info.one2oneType?s("div",[s("div",{staticClass:"primarySchool-text"},[s("div",{staticClass:"primarySchool-text-title"},[t._v("捐助对象")]),t._v(" "),s("div",{staticClass:"primarySchool-text-desc"},[s("div",{staticClass:"cell-item"},[s("div",{staticClass:"cell-i cell-i-title"},[t._v("\n              "+t._s(t.info.name)+"\n              "),s("div",{staticClass:"cell-i-sync"})]),t._v(" "),s("div",{staticClass:"cell-i"},[t._v("\n              "+t._s(t.info.age)+"岁 "+t._s(t.info.sex)+"\n            ")]),t._v(" "),s("div",{staticClass:"cell-i"},[t._v("\n              "+t._s(t.info.province)+" "+t._s(t.info.city)+"\n            ")])]),t._v(" "),s("div",{staticClass:"cell-item"},[s("div",{staticClass:"cell-i cell-i-title"},[t._v("\n              家庭情况\n            ")]),t._v(" "),s("div",{staticClass:"cell-i"},[t._v("\n              "+t._s(t.info.home_info)+"\n            ")])]),t._v(" "),s("div",{staticClass:"cell-item"},[s("div",{staticClass:"cell-i cell-i-title"},[t._v("\n              心愿\n            ")]),t._v(" "),s("div",{staticClass:"cell-i"},[t._v("\n              "+t._s(t.info.dream)+"\n            ")])]),t._v(" "),s("div",{staticClass:"cell-item"},[s("div",{staticClass:"cell-i cell-i-title"},[t._v("\n              兴趣爱好\n            ")]),t._v(" "),s("div",{staticClass:"cell-i"},[t._v("\n              "+t._s(t.info.interest)+"\n            ")])])])])]):t._e(),t._v(" "),2===t.info.one2oneType?s("div",[s("div",{staticClass:"primarySchool-text"},[s("div",{staticClass:"primarySchool-text-title"},[t._v("病人情况")]),t._v(" "),s("div",{staticClass:"primarySchool-text-desc"},[s("div",{staticClass:"cell-item"},[t._v("\n            "+t._s(t.info.donationInfo)+"\n          ")])])])]):t._e(),t._v(" "),s("div",{staticStyle:{"margin-bottom":"20%"}}),t._v(" "),s("van-tabbar",{attrs:{id:"doDonation"},model:{value:t.selected,callback:function(e){t.selected=e},expression:"selected"}},[s("van-tabbar-item",{directives:[{name:"intervalclick",rawName:"v-intervalclick",value:{func:t.pop},expression:"{func:pop}"}],staticClass:"danbibutton"},[t._v("单笔捐")])],1),t._v(" "),s("van-popup",{staticClass:"pop-bottom",attrs:{position:"bottom"},model:{value:t.showBase,callback:function(e){t.showBase=e},expression:"showBase"}},[s("h3",[t._v("输入捐款金额")]),t._v(" "),s("div",{staticStyle:{padding:"3%"}},[s("van-button",{attrs:{plain:""},on:{click:function(e){t.sendAmount="10"}}},[t._v("10TG")]),t._v(" "),s("van-button",{attrs:{plain:""},on:{click:function(e){t.sendAmount="50"}}},[t._v("50TG")]),t._v(" "),s("van-button",{attrs:{plain:""},on:{click:function(e){t.sendAmount="100"}}},[t._v("100TG")]),t._v(" "),s("van-button",{attrs:{plain:""},on:{click:function(e){t.sendAmount="150"}}},[t._v("150TG")])],1),t._v(" "),s("van-field",{attrs:{label:"TG",placeholder:"输入捐款金额"},model:{value:t.sendAmount,callback:function(e){t.sendAmount=e},expression:"sendAmount"}}),t._v(" "),s("van-button",{directives:[{name:"intervalclick",rawName:"v-intervalclick",value:{func:t.donation},expression:"{func:donation}"}],staticClass:"pop-button",attrs:{size:"large"}},[t._v("\n        下一步\n      ")])],1)],1)])},staticRenderFns:[]};var Vt=s(9)(Dt,Et,!1,function(t){s(531)},"data-v-44953b68",null).exports;new i.default({el:"#app",render:function(t){return t(Vt)}})},531:function(t,e){},532:function(t,e){},533:function(t,e){},534:function(t,e){},535:function(t,e){}},[530]);